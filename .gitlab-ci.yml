stages:
  - test
image: docker.io/library/python:latest
before_script:
  - pip install poetry
  - poetry install

formating:
  script:
    - poetry run black --check --diff .

test generation stupidly:
  script:
    - mkdir -p pkg_dest
    - |
      for pkg in $(poetry run ./src/bci_build/package.py --help|grep '{'|head -1|sed -e 's|{||' -e 's|}||' -e 's|,| |g' -e 's|\s+||'); do
          poetry run ./src/bci_build/package.py $pkg pkg_dest
      done
